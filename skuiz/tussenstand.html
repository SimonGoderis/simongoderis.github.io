  <!DOCTYPE html>
<html>
<head>
  <!-- Standard Meta -->
  <title>Index</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <link rel="icon" sizes="192x192" href="../img/icon.png">

  <!-- CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <!-- JS -->
  <script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

</head>
<body>
    <div class="container-fluid">
        <div class="row">
        <div class="col-lg-3"></div>
        <div class="col-lg-6">
        <div class="card" style="margin-top: 15px;">
            <div class="card-body">
              <h5 class="card-title">Skype</h5>
              <p class="card-text">Via de link hieronder krijg je rechtstreeks toegang tot de skype-call!</p>
              <a href="#" class="btn btn-outline-dark">Meedoen!</a>
            </div>
        </div>
        <div class="mt-2"></div>
        <div class="row">
            <div class="col-6 col-md-4 col-lg-3"><a href="./index.html" class="btn btn-outline-primary btn-block">‚Üê Links</a></div>
            <div class="col-3 col-md-6 col-lg-7"></div>
            <div class="col-3 col-md-2"><button type="button" class="btn btn-outline-primary btn-block" id="counter">60</button></div>
        </div>
        <div class="mt-2"></div>
        <div class="list-group">
            <a href="#" class="list-group-item list-group-item-action disabled active">
                <strong>Tussenstand</strong>
            </a>
                <table class="table table-hover">
                    <caption id="caption"></caption>
                    <thead class="thead-dark"> 
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Team</th>
                        <th scope="col" class="text-right">Score</th>
                      </tr>
                    </thead>
                    <tbody id="tablebody">
                        <!-- Wordt dynamisch gevuld. Hieronder wel een warning dat dit aangevuld wordt -->
                        <tr>
                            <th colspan="3" class="table-warning text-center">
                                Gegevens worden opgehaald!
                            </th>
                        </tr>
                    </tbody>
                  </table>
          </div>
          <!-- Knop om de modal te openen -->
          
          <div class="row" style="display: none;" id="rondebuttons">
            <div class="col-2"></div>
            <div class="col-1"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" onclick="rondes(this.id)" id="1" disabled>1</button></div>
            <div class="col-1"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" onclick="rondes(this.id)" id="2" disabled>2</button></div>
            <div class="col-1"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" onclick="rondes(this.id)" id="3" disabled>3</button></div>
            <div class="col-1"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" onclick="rondes(this.id)" id="4" disabled>4</button></div>
            <div class="col-1"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" onclick="rondes(this.id)" id="5" disabled>5</button></div>
            <div class="col-1"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" onclick="rondes(this.id)" id="6" disabled>6</button></div>
            <div class="col-1"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" onclick="rondes(this.id)" id="7" disabled>7</button></div>
            <div class="col-1"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" onclick="rondes(this.id)" id="8" disabled>8</button></div>
            <div class="col-2"></div>
          </div>
        </div>
        <div class="col-lg-3"></div>
        <div class="mt-2"></div>
        </div>
    </div>

    <!-- Modal voor punten van de rondes -->
    <div class="modal" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <table class="table table-hover">
              <caption id="caption"></caption>
              <thead class="thead-dark"> 
                <tr>
                  <th scope="col">Ronde</th>
                  <th scope="col">Score</th>
                </tr>
              </thead>
              <tbody id="tablebodymodal">
                  <!-- Wordt dynamisch gevuld. Hieronder wel een warning dat dit aangevuld wordt -->
                  <tr>
                      <th colspan="2" class="table-warning text-center">
                          Gegevens worden opgehaald!
                      </th>
                  </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
</body>
<script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>
<script type='text/javascript'>    
  var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1oFHAUBxUSEpRxUcdiMr2SW9hnz7jDXEN1lFC40hKpVo/edit?usp=sharing';
  var arr1 = [];

  function init() {
    Tabletop.init( { key: publicSpreadsheetUrl,
                     callback: showInfo,
                     simpleSheet: true } )
  }

  function showInfo(data, tabletop) {
    arr1 = data.slice();
    arr1 = arr1.sort(function(a, b) {
    return a['#'] - b['#'];
    });
    data = data.sort(function(a, b) {
    return b.Totaal - a.Totaal;
    });
    console.log(data);
    document.getElementById('tablebody').innerHTML = "";
    lengte = data.length;
    var spelers = 0;
    for (i = 0; i < lengte; i++) {
        if (data[i].Team != "") {
            document.getElementById('tablebody').insertAdjacentHTML('beforeend', "<tr><th scope='row'>" + (i+1) + "</th><td>" + data[i].Team + "</td><td class='text-right'>" + data[i].Totaal + "</td></tr>");
            spelers = spelers + 1
        }
    }
    for (i=1; i < (spelers + 1); i++){
      document.getElementById(i).disabled = false;
    }
    $("#rondebuttons").show();

    // TODO: buttons onderaan dynamisch toevoegen op basis van het aantal spelers die meedoen. Of zorgen dat er disabled zijn. 

    // De caption zal getoond worden telkens de data ververst wordt. 
    document.getElementById("caption").innerHTML = "Laatste update: " + (new Date()).toLocaleTimeString();
  }

  function rondes(i) {
      console.log(arr1[i-1]);
      document.getElementById('tablebodymodal').innerHTML = "";
      document.getElementById('exampleModalLongTitle').innerHTML = arr1[i-1].Team;
      document.getElementById('tablebodymodal').insertAdjacentHTML('beforeend', "<tr id='r1'><td>Ronde 1</td><td>" + arr1[i-1]['Ronde 1'] + "</td></tr><tr id='r2'><td>Ronde 2</td><td>" + arr1[i-1]['Ronde 2'] + "</td></tr><tr id='r3'><td>Ronde 3</td><td>" + arr1[i-1]['Ronde 3'] + "</td></tr><tr d='r4'><td>Ronde 4</td><td>" + arr1[i-1]['Ronde 4'] + "</td></tr><tr><td>Tussenronde</td><td>" + arr1[i-1]['Tussenronde'] + "</td></tr><tr id='r5'><td>Ronde 5</td><td>" + arr1[i-1]['Ronde 5'] + "</td></tr><tr id='r6'><td>Ronde 6</td><td>" + arr1[i-1]['Ronde 6'] + "</td></tr><tr id='r7'><td>Ronde 7</td><td>" + arr1[i-1]['Ronde 7'] + "</td></tr><tr class='bg-dark text-white'><td>Totaal</td><td>" + arr1[i-1]['Totaal'] + "</td></tr>");
      $("#r" + arr1[i-1].Groen).addClass("table-success");
      $("#r" + arr1[i-1].Rood).addClass("table-danger");
  }

  // Countdown timer
  var count = 60, timer = setInterval(function() {
    $("#counter").html(count--);
    if(count == 0){
        count = 60;
        init();
    }
  }, 1000)

  window.addEventListener('DOMContentLoaded', init)
</script>
</html>
