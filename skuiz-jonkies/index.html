<!DOCTYPE html>
<html>

<head>
    <!-- Standard Meta -->
    <title>Skuiz - Links</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="icon" sizes="192x192" href="./img/icon.png">

    <!-- CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/style.css">

    <style>
        .ronde {
            /* uitzetten door als commentaar te zetten */
            color: #6c757d;
            pointer-events: none;
        }

        .skype {
            color: #343a40;
            pointer-events: none;
            opacity: .65;
        }
    </style>

    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>


</head>

<body>
    <nav class="navbar navbar-primary bg-primary">
        <div class="row">
            <div class="col-lg-3"></div>
            <div class="col-lg-6">
                <a class="navbar-brand" href="./index.html" style="margin-left: 10px;">
                    <img src="./img/logo.png" width="20%" alt="logo">
                </a>
            </div>
            <div class="col-lg-3"></div>
        </div>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-3"></div>
            <div class="col-lg-6">
                <div class="mt-2"></div>
                <div class="row">
                    <div class="col-5 col-md-5 col-lg-4">
                    </div>
                    <div class="col-1 col-md-2 col-lg-4"></div>
                    <div class="col-6 col-md-5 col-lg-4">
                        <a href="./tussenstand.html" class="btn btn-outline-primary btn-block">
                            Tussenstand â†’
                        </a>
                    </div>
                </div>
                <div class="mt-2"></div>
                <div class="alert alert-warning text-center" role="alert"
                    style="margin-top: 16px!important; display: none;">
                    Er is momenteel geen Skuiz bezig. De volgende editie staat gepland op <strong>11/04</strong> (20u).
                </div>
                <div class="list-group">
                    <a href="#" class="list-group-item list-group-item-action disabled active">
                        <strong>Rondes</strong>
                    </a>
                    <a href="https://forms.gle/AQouPMf29NUSaVay5" target="_blank"
                        class="list-group-item list-group-item-action ronde" id="r1">
                        Ronde 1
                    </a>
                    <a href="https://forms.gle/dnBcW3tWWGk3qgFg7" target="_blank"
                        class="list-group-item list-group-item-action ronde" id="r2">
                        Ronde 2
                    </a>
                    <a href="https://forms.gle/dnBdWWHc7PfVUtxX8" target="_blank"
                        class="list-group-item list-group-item-action ronde" id="r3">
                        Ronde 3
                    </a>
                    <a href="https://forms.gle/MMtSbdBe1szzmu97A" target="_blank"
                        class="list-group-item list-group-item-action ronde" id="r4">
                        Ronde 4
                    </a>
                    <a href="https://forms.gle/hXNBfW7aeRaR8N1m7" target="_blank"
                        class="list-group-item list-group-item-action ronde" id="r5">
                        Ronde 5
                    </a>
                    <a href="https://forms.gle/qgQXPsn9xp3Y41j38" target="_blank"
                        class="list-group-item list-group-item-action ronde" id="r6">
                        Ronde 6
                    </a>
                    <a href="https://forms.gle/3d1F7ocD1GtYT2jdA" target="_blank"
                        class="list-group-item list-group-item-action ronde" id="r7">
                        Ronde 7
                    </a>
                    <a href="#" target="_blank" class="list-group-item list-group-item-action disabled active">
                        <strong>Extra</strong>
                    </a>
                    <a href="#" target="_blank"
                        class="list-group-item list-group-item-action ronde" id="rt">
                        Tussenronde
                    </a>
                </div>
                <div class="card" style="margin-top: 15px;">
                    <div class="card-body">
                        <h5 class="card-title">Skype</h5>
                        <p class="card-text">Via de link hieronder krijg je rechtstreeks toegang tot de skype-call!</p>
                        <a href="#" class="btn btn-outline-dark skype"
                            target="_blank" id="skype">Meedoen!</a>
                    </div>
                </div>
            </div>
            <div class="col-lg-3"></div>
        </div>
        <div class="mt-2"></div>
    </div>
</body>

<script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>

<script type='text/javascript'>
    var publicSpreadsheetUrl =
      'https://docs.google.com/spreadsheets/d/1shPlEE28fNySlOrckbnx40HZOqh4jxB4QdL4C7ZEH08/edit?usp=sharing';

    function init() {
      Tabletop.init({
        key: publicSpreadsheetUrl,
        callback: showInfo,
        simpleSheet: true
      })
    }

    function showInfo(data, tabletop) {

        console.log(data);

        // voegt tussenronde toe.
        if(data[4]['Toon links'] != ''){
            $("#rt").attr("href", data[4]['Toon links']);
        }
      
      // Toont links op basis van de instellingen in het excel-bestand. 

      if(data[0]['Toon links']=="Ja") {
          for (i = 1; i<8; i++) {
            $("#r" + i).removeClass('ronde');
          }
          $("#rt").removeClass('ronde');
      } else {
        for (i = 1; i<8; i++) {
            $("#r" + i).addClass('ronde');
          }
          $("#rt").addClass('ronde');
      }

      // Toont skype link als deze ingevuld is in het excel-bestand. 

      if(data[2]['Toon links'] != '') {
        $("#skype").attr("href", data[2]['Toon links']);
        $("#skype").removeClass('skype');
      } else {
        $("#skype").addClass('skype');
      }

    }

    // Countdown timer
    var count = 60,
      timer = setInterval(function () {
        count--;
        if (count == 0) {
          count = 60;
          init();
          console.log("Refresh completed.");
        }
      }, 1000)

    window.addEventListener('DOMContentLoaded', init)
</script>

</html>
